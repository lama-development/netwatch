{% extends "base.html" %}

{% block title %}Alerts - NetWatch{% endblock %}

{% block css %}
<link rel="stylesheet" href="/static/css/pages/alerts.css">
{% endblock %}

{% block content %}
<header>
    <h1>Alerts</h1>
</header>

<section>
    <div class="alerts-dashboard">
        <div class="alerts-summary">
            <div id="total-alerts" class="total-number">0</div>
            <div class="total-text">Active Alerts</div>
        </div>
        
        <div class="alert-levels">
            <div class="alert-level" id="level-critical">
                <i class="bx bxs-error-circle"></i>
                <div class="level-count">0</div>
                <div class="level-name">Critical</div>
            </div>
            <div class="alert-level" id="level-warning">
                <i class="bx bxs-error"></i>
                <div class="level-count">0</div>
                <div class="level-name">Warning</div>
            </div>
            <div class="alert-level" id="level-info">
                <i class="bx bxs-info-circle"></i>
                <div class="level-count">0</div>
                <div class="level-name">Info</div>
            </div>
        </div>
    </div>
</section>

<section id="alerts-list">
    <div class="alerts-header">
        <h2>Active Alerts</h2>
        <div class="alert-actions">
            <!-- Refresh button removed as it should update automatically -->
            <select id="filter-severity" class="filter-select">
                <option value="all">All Severities</option>
                <option value="critical">Critical</option>
                <option value="warning">Warning</option>
                <option value="info">Info</option>
            </select>
            <select id="filter-status" class="filter-select">
                <option value="all">All Statuses</option>
                <option value="active">Active</option>
                <option value="acknowledged">Acknowledged</option>
            </select>
        </div>
    </div>
    
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th data-sort="timestamp">Time <i class='bx bx-sort'></i></th>
                    <th data-sort="device">Device <i class='bx bx-sort'></i></th>
                    <th data-sort="severity">Severity <i class='bx bx-sort'></i></th>
                    <th data-sort="type">Type <i class='bx bx-sort'></i></th>
                    <th data-sort="message">Message <i class='bx bx-sort'></i></th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="alerts-table-body">
                <!-- Alert rows will be inserted here via JavaScript -->
            </tbody>
        </table>
    </div>
    <div id="pagination"></div>
    
    <div id="no-alerts-message" class="hidden">
        <i class='bx bx-check-circle'></i>
        <p>No alerts found. All systems operating normally.</p>
    </div>
</section>

<section id="alert-settings">
    <h2>Alert Settings</h2>
    <form id="alert-settings-form">
        <div class="form-group">
            <label for="email-notifications">Email Notifications</label>
            <div class="checkbox-container">
                <input type="checkbox" id="email-notifications" name="email_notifications">
                <label for="email-notifications">Receive email notifications for critical alerts</label>
            </div>
        </div>
        
        <div class="form-group">
            <label for="notification-email">Notification Email</label>
            <input type="email" id="notification-email" name="notification_email" placeholder="your@email.com">
        </div>
        
        <div class="form-group">
            <label for="alert-retention">Alert Retention (days)</label>
            <input type="number" id="alert-retention" name="alert_retention" min="1" max="90" value="30">
            <p class="description">Number of days to keep alert history.</p>
        </div>
        
        <button type="submit" class="save-button">
            <i class='bx bx-save'></i> Save Settings
        </button>
    </form>
    
    <!-- Popup for confirmation messages -->
    <div id="popup" class="popup"></div>
</section>

<!-- Alert Details Modal -->
<div id="alert-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Alert Details</h3>
            <button class="close-modal"><i class='bx bx-x'></i></button>
        </div>
        <div class="modal-body">
            <div class="alert-detail">
                <span class="detail-label">Device:</span>
                <span id="modal-device" class="detail-value"></span>
            </div>
            <div class="alert-detail">
                <span class="detail-label">Time:</span>
                <span id="modal-time" class="detail-value"></span>
            </div>
            <div class="alert-detail">
                <span class="detail-label">Type:</span>
                <span id="modal-type" class="detail-value"></span>
            </div>
            <div class="alert-detail">
                <span class="detail-label">Severity:</span>
                <span id="modal-severity" class="detail-value"></span>
            </div>
            <div class="alert-detail">
                <span class="detail-label">Status:</span>
                <span id="modal-status" class="detail-value"></span>
            </div>
            <div class="alert-detail">
                <span class="detail-label">Message:</span>
                <span id="modal-message" class="detail-value"></span>
            </div>
            <div class="alert-detail">
                <span class="detail-label">Description:</span>
                <p id="modal-description" class="detail-value"></p>
            </div>
        </div>
        <div class="modal-footer">
            <button id="acknowledge-alert" class="action-button acknowledge">
                <i class='bx bx-check'></i> Acknowledge Alert
            </button>
            <button id="resolve-alert" class="action-button resolve">
                <i class='bx bx-check-double'></i> Resolve Alert
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block bottom_js %}
<script src="/static/js/alerts.js" defer></script>
{% endblock %}